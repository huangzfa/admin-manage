<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.duobei.core.user.user.dao.UserCouponDao">

  <sql id="Base_Column_List">
    ucoupon.id as id, ucoupon.product_id as product_id, ucoupon.user_id as user_id,
    ucoupon.coupon_id as coupon_id, ucoupon.coupon_type as coupon_type,
    ucoupon.state as state, ucoupon.time_flag as time_flag, ucoupon.start_time as start_time,
    ucoupon.end_time as end_time, ucoupon.used_time as used_time, ucoupon.from_type as from_type,
    ucoupon.from_ref as from_ref, ucoupon.add_time as add_time, ucoupon.modify_time as modify_time,
    ucoupon.is_delete as is_delete
  </sql>
  <select id="getByUserIdAndState" resultType="com.duobei.core.user.user.domain.vo.UserCouponVo">
    select <include refid="Base_Column_List"/>
    from pgy_user_coupon ucoupon
    where ucoupon.is_delete = 0 and ucoupon.user_id = #{userId} and ucoupon.state = #{state}
    order by ${orderName} desc
  </select>
</mapper>